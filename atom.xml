<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[reg88.com]]></title>
  <link href="http://mmoghadas.github.io/atom.xml" rel="self"/>
  <link href="http://mmoghadas.github.io/"/>
  <updated>2014-07-31T17:26:14-07:00</updated>
  <id>http://mmoghadas.github.io/</id>
  <author>
    <name><![CDATA[Mike Moghadas]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Installing and configuring Puppetmaster and Puppet Clients (On Ubuntu)]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/03/01/installing-and-configuring-puppetmaster-and-puppet-clients-on-ubuntu/"/>
    <updated>2012-03-01T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/03/01/installing-and-configuring-puppetmaster-and-puppet-clients-on-ubuntu</id>
    <content type="html"><![CDATA[<p>Puppet is a great Client/Server automation tool for your *NIX environment. The tool can be used to automate:</p>

<p>Installations<br/>
Updates<br/>
Deployment<br/>
Service manipulation<br/>
etc&#8230;</p>

<p>NOTE: Typically, the client(puppet/node) retrieves updates from the server (Puppetmaster). However you can enable push from the server to client as well. See &#8220;Client Configuration&#8221;.</p>

<p>Follow the below steps to get a basic configuration going.</p>

<!--more-->


<p><strong>Installation: Server</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">puppetmaster</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Installation: Client</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">puppet</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Note: </strong><em>Although not required, you may want to make sure you have the same version of Puppet and Puppetmaster. I have Puppet 2.6.3 and Puppetmaster 2.7.1 running sucessfully, but have had issues with previous versions and installations.</em></p>

<p>If you like to install the same exact version of client/server you have some options:<br/>
1. Install via Ruby</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">zlib1g</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxml2</span> <span class="n">libxml2</span><span class="o">-</span><span class="n">dev</span> <span class="n">curl</span> <span class="n">wget</span> <span class="n">openssl</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">libopenssl</span><span class="o">-</span><span class="n">ruby</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.2-p180.tar.gz  </span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">ruby</span><span class="o">-</span><span class="mf">1.9.2</span><span class="o">-</span><span class="n">p180</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span><span class='line'><span class="n">cd</span> <span class="n">ruby</span><span class="o">-</span><span class="mf">1.9.2</span><span class="o">-</span><span class="n">p180</span>
</span><span class='line'><span class="p">.</span><span class="o">/</span><span class="n">configure</span>
</span><span class='line'><span class="n">make</span>
</span><span class='line'><span class="n">make</span> <span class="n">install</span>
</span><span class='line'><span class="n">gem</span> <span class="n">update</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">system</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="n">install</span> <span class="n">facter</span>
</span><span class='line'><span class="n">gem</span> <span class="n">install</span> <span class="n">puppet</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Install from source (Assuming you have ruby installed)</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//puppetlabs.com/downloads/facter/facter-latest.tgz  </span>
</span><span class='line'><span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">c</span> <span class="n">facter</span><span class="o">-</span><span class="n">latest</span><span class="p">.</span><span class="n">tgz</span> <span class="o">|</span> <span class="n">tar</span> <span class="n">xf</span> <span class="o">-</span>
</span><span class='line'><span class="n">cd</span> <span class="n">facter</span><span class="o">-*</span>
</span><span class='line'><span class="n">ruby</span> <span class="n">install</span><span class="p">.</span><span class="n">rb</span>
</span><span class='line'>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//puppetlabs.com/downloads/puppet/puppet-latest.tgz  </span>
</span><span class='line'><span class="n">gzip</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">c</span> <span class="n">puppet</span><span class="o">-</span><span class="n">latest</span><span class="p">.</span><span class="n">tgz</span> <span class="o">|</span> <span class="n">tar</span> <span class="n">xf</span> <span class="o">-</span>
</span><span class='line'><span class="n">ruby</span> <span class="n">install</span><span class="p">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Another way to install</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">ruby</span> <span class="n">rubygems</span> <span class="n">libopenssl</span><span class="o">-</span><span class="n">ruby</span>
</span><span class='line'><span class="n">export</span> <span class="n">RUBYOPT</span><span class="o">=</span><span class="n">rubygems</span>
</span><span class='line'><span class="n">gem</span> <span class="n">install</span> <span class="n">facter</span> <span class="n">puppet</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Install form 3rd Party repository</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">software</span><span class="o">-</span><span class="n">properties</span>
</span><span class='line'><span class="n">add</span><span class="o">-</span><span class="n">apt</span><span class="o">-</span><span class="n">repository</span> <span class="n">ppa</span><span class="o">:</span><span class="n">mathiaz</span><span class="o">/</span><span class="n">puppet</span><span class="o">-</span><span class="n">backports</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">puppetmaster</span>
</span><span class='line'><span class="o">-</span><span class="n">OR</span><span class="o">-</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">puppet</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configuration: Server</strong><br/>
Edit the puppet.conf file and add the following lines</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">puppet</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="p">[</span><span class="n">agent</span><span class="p">]</span>
</span><span class='line'><span class="n">classfile</span> <span class="o">=</span> <span class="err">$</span><span class="n">vardir</span><span class="o">/</span><span class="n">classes</span><span class="p">.</span><span class="n">txt</span>
</span><span class='line'><span class="n">localconfig</span> <span class="o">=</span> <span class="err">$</span><span class="n">vardir</span><span class="o">/</span><span class="n">localconfig</span>
</span><span class='line'><span class="n">report</span> <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">master</span><span class="p">]</span>
</span><span class='line'><span class="n">autosign</span> <span class="o">=</span> <span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Edit the fileserver.conf file and add the following lines</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">fileserver</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">files</span><span class="p">]</span>
</span><span class='line'><span class="n">path</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">files</span>
</span><span class='line'><span class="n">allow</span> <span class="mf">10.176.0.0</span><span class="o">/</span><span class="mi">16</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">plugins</span><span class="p">]</span>
</span><span class='line'><span class="n">allow</span> <span class="mf">10.176.0.0</span><span class="o">/</span><span class="mi">16</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">modules</span><span class="p">]</span>
</span><span class='line'><span class="n">allow</span> <span class="mf">10.176.0.0</span><span class="o">/</span><span class="mi">16</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create the files directory specified above (required to start the puppetmaster service)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">files</span>
</span></code></pre></td></tr></table></div></figure>


<p>Configure your nodes (client) below. The templates will apply to these nodes only.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">nodes</span><span class="p">.</span><span class="n">pp</span>
</span><span class='line'>
</span><span class='line'><span class="n">node</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">basenode</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span> <span class="p">{</span>
</span><span class='line'><span class="n">include</span> <span class="n">baseclass</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">node</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">mobile101</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span> <span class="n">inherits</span> <span class="n">basenode</span> <span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">node</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">mobile102</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span> <span class="n">inherits</span> <span class="n">basenode</span> <span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Configure your templates. Here you&#8217;re listing the modules will effect your clients.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">templates</span><span class="p">.</span><span class="n">pp</span>
</span><span class='line'>
</span><span class='line'><span class="n">node</span> <span class="k">default</span> <span class="p">{</span>
</span><span class='line'><span class="n">include</span> <span class="n">baseclass</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">class</span> <span class="n">baseclass</span> <span class="p">{</span>
</span><span class='line'><span class="n">include</span> <span class="n">mobile</span><span class="o">::</span><span class="n">mobile_content</span>
</span><span class='line'><span class="n">include</span> <span class="n">mobile</span><span class="o">::</span><span class="n">mobile_settings</span>
</span><span class='line'><span class="n">include</span> <span class="n">mobile</span><span class="o">::</span><span class="n">mobile</span><span class="err">\</span><span class="n">_wsgi</span><span class="err">\</span><span class="n">_app</span>
</span><span class='line'><span class="n">include</span> <span class="n">mobile</span><span class="o">::</span><span class="n">mobile_django</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Edit the site.pp and import your nodes and templates</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">site</span><span class="p">.</span><span class="n">pp</span>
</span><span class='line'>
</span><span class='line'><span class="n">import</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">nodes</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">import</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">templates</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">filebucket</span> <span class="p">{</span> <span class="n">main</span><span class="o">:</span> <span class="n">server</span> <span class="o">=&gt;</span> <span class="n">puppet</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Restart puppetmaster to enable the above changes</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">puppetmaster</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configuration: Client</strong><br/>
There are only a few steps to get the client up and running. First up is the puppet main configuration file. Edit the file below and make changes.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">puppet</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="err">\#</span> <span class="n">VERY</span> <span class="n">IMPORTANT</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8230</span><span class="p">;</span> <span class="n">THE</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">SERVER</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="n">VARIABLE</span> <span class="n">MUST</span> <span class="n">BE</span> <span class="n">USING</span> <span class="n">THE</span> <span class="n">HOSTNAME</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">PUPPETMASTER</span><span class="p">..</span><span class="n">NOT</span> <span class="n">AN</span> <span class="n">ALIAS</span><span class="o">!!</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">main</span><span class="p">]</span>
</span><span class='line'><span class="n">server</span> <span class="o">=</span> <span class="n">puppetmaster</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#[puppetmasterd]  </span>
</span><span class='line'><span class="cp">#templatedir=/var/lib/puppet/templates</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">agent</span><span class="p">]</span>
</span><span class='line'><span class="n">report</span> <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="n">listen</span> <span class="o">=</span> <span class="nb">true</span>
</span><span class='line'><span class="n">runinterval</span> <span class="o">=</span> <span class="mi">3600</span> <span class="err">#</span><span class="mi">1</span> <span class="n">hour</span>
</span></code></pre></td></tr></table></div></figure>


<p>Configure puppet to automatically at boot</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">puppet</span>
</span><span class='line'><span class="n">START</span><span class="o">=</span><span class="n">yes</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create the following required file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">namespaceauth</span><span class="p">.</span><span class="n">conf</span>
</span></code></pre></td></tr></table></div></figure>


<p>Created the following file if you like to push content manually from the server.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">auth</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">path</span> <span class="o">/</span><span class="n">run</span>
</span><span class='line'><span class="n">allow</span> <span class="n">puppetmaster</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example, I&#8217;m using upstart to recycle a service. You&#8217;ll to copy &#8220;upstart.rb&#8221; from the server to client.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ruby</span><span class="o">/</span><span class="mf">1.8</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">provider</span><span class="o">/</span><span class="n">service</span><span class="o">/</span>
</span><span class='line'><span class="n">scp</span> <span class="n">username</span><span class="p">@</span><span class="n">puppetmaster</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ruby</span><span class="o">/</span><span class="mf">1.8</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">provider</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="n">upstart</span><span class="p">.</span><span class="n">rb</span> <span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configuration: Certificate</strong><br/>
STEP1: On the Client:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">puppetd</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span> <span class="n">puppetmaster</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">waitforcert</span> <span class="mi">60</span>
</span></code></pre></td></tr></table></div></figure>


<p>STEP2: On the Server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">puppetca</span> <span class="o">-</span><span class="n">la</span>
</span><span class='line'><span class="n">puppetca</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">sign</span> <span class="n">mobile101</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'><span class="n">puppetca</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">sign</span> <span class="n">mobile102</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span></code></pre></td></tr></table></div></figure>


<p>STEP3: On the Client:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">pkill</span> <span class="n">puppet</span>
</span><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">puppet</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>


<p>STEP4: Only if necessary: Troubleshooting Certificate Issues:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">#On the server  </span>
</span><span class='line'><span class="n">puppetca</span> <span class="o">-</span><span class="n">r</span> <span class="n">mobile101</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'><span class="n">puppetca</span> <span class="o">-</span><span class="n">c</span> <span class="n">mobile101</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">puppetmaster</span> <span class="n">restart</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#On the client  </span>
</span><span class='line'><span class="n">pkill</span> <span class="n">puppetd</span>
</span><span class='line'><span class="n">rm</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span> <span class="o">-</span><span class="n">rf</span>
</span></code></pre></td></tr></table></div></figure>


<p>
Repeat the certificate creation process</p>

<p><strong>Configuration: Modules</strong><br/>
At this point there are no configuration left on the client. As long as the certificate was configured properly all changes make beyond this point are all on the server. Lets configure a mobile module we included in the configuration above. Lets start off with the required directory structure.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">files</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">files</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">manifests</span>
</span></code></pre></td></tr></table></div></figure>


<p>The files directory structure is listed below. In this case we&#8217;re assuming you&#8217;re going to be deploying a website named &#8220;mobile&#8221; with it&#8217;s root/content of &#8220;var/www/mobile&#8221;. You can touch these files for this example.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">ls</span> <span class="o">-</span><span class="n">m</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/*</span>
</span><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">files</span><span class="o">:</span>
</span><span class='line'><span class="n">mobile</span>
</span><span class='line'>
</span><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">puppet</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">manifests</span><span class="o">:</span>
</span><span class='line'><span class="n">config</span><span class="p">.</span><span class="n">pp</span><span class="p">,</span> <span class="n">init</span><span class="p">.</span><span class="n">pp</span><span class="p">,</span> <span class="n">service</span><span class="p">.</span><span class="n">pp</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify the init.pp file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">class</span> <span class="n">mobile</span> <span class="p">{</span>
</span><span class='line'><span class="n">include</span> <span class="n">mobile</span><span class="o">::</span><span class="n">config</span><span class="p">,</span> <span class="n">mobile</span><span class="o">::</span><span class="n">service</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify the config.pp file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">class</span> <span class="n">mobile</span><span class="o">::</span><span class="n">config</span> <span class="p">{</span>
</span><span class='line'><span class="n">file</span> <span class="p">{</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">:</span>
</span><span class='line'><span class="n">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
</span><span class='line'><span class="n">source</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">puppet</span><span class="o">:</span><span class="c1">///modules/mobile/mobile&amp;#8221;,  </span>
</span><span class='line'><span class="n">recurse</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">group</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">owner</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">mode</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="mo">0644</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">file</span> <span class="p">{</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="n">settings</span><span class="p">.</span><span class="n">py</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">:</span>
</span><span class='line'><span class="n">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
</span><span class='line'><span class="n">source</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">puppet</span><span class="o">:</span><span class="c1">///modules/mobile/settings.py&amp;#8221;,  </span>
</span><span class='line'><span class="n">recurse</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">group</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">owner</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">mode</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="mo">0644</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">file</span> <span class="p">{</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="n">wsgi_app</span><span class="p">.</span><span class="n">py</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">:</span>
</span><span class='line'><span class="n">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
</span><span class='line'><span class="n">source</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">puppet</span><span class="o">:</span><span class="c1">///modules/mobile/wsgi_app.py&amp;#8221;,  </span>
</span><span class='line'><span class="n">recurse</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">group</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">owner</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">mode</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="mo">0644</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">file</span> <span class="p">{</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="n">django</span><span class="p">.</span><span class="n">wsgi</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">:</span>
</span><span class='line'><span class="n">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
</span><span class='line'><span class="n">source</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">puppet</span><span class="o">:</span><span class="c1">///modules/mobile/django.wsgi&amp;#8221;,  </span>
</span><span class='line'><span class="n">recurse</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">group</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">owner</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">mode</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="mo">0644</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify the service.pp file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">class</span> <span class="n">mobile</span><span class="o">::</span><span class="n">service</span> <span class="p">{</span>
</span><span class='line'><span class="n">service</span> <span class="p">{</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">mobile</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">:</span>
</span><span class='line'><span class="n">provider</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">upstart</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;,</span>
</span><span class='line'><span class="n">ensure</span> <span class="o">=&gt;</span> <span class="n">running</span><span class="p">,</span>
</span><span class='line'><span class="n">hasstatus</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">hasrestart</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">enable</span> <span class="o">=&gt;</span> <span class="nb">true</span><span class="p">,</span>
</span><span class='line'><span class="n">subscribe</span> <span class="o">=&gt;</span> <span class="n">File</span><span class="p">[</span><span class="s">&quot;/var/www/mobile/MobileTicketSales/settings.py&quot;</span><span class="p">],</span>
</span><span class='line'><span class="cp">#require =&gt; Class[&quot;mobile::config&quot;],  </span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&#8217;s all she wrote. Your clients should retrive any changes hourly (based on configuration above). If you like to push content manually from the server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">puppetrun</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">host</span> <span class="n">mobile101</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to install Homebrew on OSX Lion]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/02/22/how-to-install-homebrew-on-osx-lion/"/>
    <updated>2012-02-22T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/02/22/how-to-install-homebrew-on-osx-lion</id>
    <content type="html"><![CDATA[<p>Homebrew is a tool that allow you to install some missing open-source packages in OSX. This of Homebrew as apt-get for OSX. It&#8217;s also an alternative to Port, but I think this just works better.</p>

<p>Assuming you&#8217;re installing Homebrew on OSX Lion, you&#8217;ll need the following:</p>

<ul>
<li>OSX Lion<br/>
-Xcode (Can be installed via AppStore)<br/>
-Xcode Command Line Tools (You&#8217;ll need an Apple Developers Account)</li>
</ul>


<!--more-->


<p><strong>To install Xcode Command Line Tools</strong><br/>
Launch Xcode > Preferences > Downloads > Command Line Tools > Install</p>

<p><strong>To install Homebrew</strong><br/>
From Terminal</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">ruby</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="err">$</span><span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">curl</span> <span class="o">-</span><span class="n">fksSL</span> <span class="n">https</span><span class="o">:</span><span class="c1">//raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)&amp;#8221;  </span>
</span></code></pre></td></tr></table></div></figure>


<p>Now you should be able to install available Unix Tools.<br/>
<strong>To install packages</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">brew</span> <span class="n">install</span> <span class="o">&lt;</span><span class="n">tool_name</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">brew</span> <span class="n">install</span> <span class="n">git</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Remote Logging Server: Syslog | Rsyslog]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/02/01/remote-logging-server-syslog-rsyslog/"/>
    <updated>2012-02-01T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/02/01/remote-logging-server-syslog-rsyslog</id>
    <content type="html"><![CDATA[<p>Enabling remote logging on in linux is very simple. Most distributions include Syslog and most recently Rsyslog. The configuration is different between these two products, but can get either excepting remote logs by editing a single file. You should always read the man pages and read about syslog security while at it.</p>

<!--more-->


<p>Syslog<br/>
# Add &#8220;-r&#8221; to the end of the &#8220;RSYSLOGD_OPTIONS&#8221;. Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">syslog</span>
</span><span class='line'><span class="n">RSYSLOGD_OPTIONS</span><span class="o">=&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="o">-</span><span class="n">c3</span> <span class="o">-</span><span class="n">r</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">service</span> <span class="n">syslog</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>


<p>Rsyslog<br/>
# Uncomment the following lines in /etc/rsyslog.conf file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span><span class="n">ModLoad</span> <span class="n">imudp</span>
</span><span class='line'><span class="err">$</span><span class="n">UDPServerRun</span> <span class="mi">514</span>
</span><span class='line'>
</span><span class='line'><span class="n">service</span> <span class="n">rsyslog</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Note to Self: Don&#8217;t use scripts on blogger!]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/02/01/note-to-self-dont-use-scripts-on-blogger/"/>
    <updated>2012-02-01T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/02/01/note-to-self-dont-use-scripts-on-blogger</id>
    <content type="html"><![CDATA[<p>I recently migrated my blog from Blogger to WordPress. I added a simple redirect to the old blog (Blogger) to forward to my new blog. Two hours later&#8230;</p>

<ul>
<li>my Google account was locked!</li>
<li>my Blogger blog was DELETED!</li>
</ul>


<p>Fortunately, I was able to recover my account and I had already backed up my blogger content.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Configure and Install WordPress on Nginx + PHP-FPM]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/02/01/347/"/>
    <updated>2012-02-01T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/02/01/347</id>
    <content type="html"><![CDATA[<p>I had been using Blogger (Blogspot) for several years, but even with the latest improvements Blogger just doesn&#8217;t cut it. I have finally given up and moving on to WordPress. At this point why not host my own install. I decided to get an install going with Nginx, PHP-FPM and WordPress. Here&#8217;s a how-to on getting you own up and running as well.</p>

<!--more-->


<p><strong>Package Installation and Initial Prep</strong><br/>
For the most part, we&#8217;re going to compile our own packages, but lets get some of the requirements out of the with via Ubuntu&#8217;s repository. The following installs packages required to build and install from source. Also, Nginx is installed to take care of some of the prerequisites and configuration files.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">supervisor</span> <span class="n">nginx</span> <span class="n">libxml2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpcre3</span> <span class="n">libpcre3</span><span class="o">-</span><span class="n">dev</span> <span class="n">libbz2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libmcrypt</span><span class="o">-</span><span class="n">dev</span> <span class="n">libmhash</span><span class="o">-</span><span class="n">dev</span> <span class="n">libmhash2</span> <span class="n">libcurl4</span><span class="o">-</span><span class="n">openssl</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpq</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpq5</span> <span class="n">unzip</span> <span class="n">bison</span> <span class="n">flex</span> <span class="n">autoconf</span> <span class="n">subversion</span> <span class="n">rcconf</span> <span class="n">mysql</span><span class="o">-</span><span class="n">server</span> <span class="n">ntp</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&#8217;re going to compile Nginx in a later step so lets remove it for now. Remove and purge Nginx installation. NOTE: Configuration and startup files are left behind. And this is exactly what we want.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">remove</span> <span class="n">nginx</span> <span class="o">&amp;&amp;</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="n">nginx</span> <span class="o">&amp;&amp;</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">autoremove</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Create a download and builds directory</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>PHP Installation</strong><br/>
Download, Configure and Install PHP + PHP-FPM</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//us2.php.net/get/php-5.3.9.tar.gz/from/us.php.net/mirror (http://us.php.net/distributions/php-5.3.9.tar.gz)  </span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">php</span><span class="o">-</span><span class="mf">5.3.9</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span><span class='line'><span class="n">cd</span> <span class="n">php</span><span class="o">-</span><span class="mf">5.3.9</span>
</span><span class='line'>
</span><span class='line'><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">fpm</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">mcrypt</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">zlib</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">mbstring</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">disable</span><span class="o">-</span><span class="n">pdo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">pgsql</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">curl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">disable</span><span class="o">-</span><span class="n">debug</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">disable</span><span class="o">-</span><span class="n">rpath</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="kr">inline</span><span class="o">-</span><span class="n">optimization</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">bz2</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">zlib</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">sockets</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">sysvsem</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">sysvshm</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">pcntl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">mbregex</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">mhash</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">enable</span><span class="o">-</span><span class="n">zip</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">pcre</span><span class="o">-</span><span class="n">regex</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">mysql</span><span class="o">=</span><span class="n">mysqlnd</span>
</span><span class='line'>
</span><span class='line'><span class="n">make</span>
</span><span class='line'><span class="n">make</span> <span class="n">test</span>
</span><span class='line'><span class="n">make</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>PHP and PHP-FPM Configuration</strong><br/>
At this point we need to create some links to make sure php is working properly with out setup</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cp</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="mf">5.3.9</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span><span class="o">-</span><span class="n">production</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span>
</span><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">/</span>
</span><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span>
</span><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="k">default</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">php</span><span class="p">.</span><span class="n">ini</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify the php-fpm.conf file with the following changes</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">listen</span><span class="p">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>
</span><span class='line'><span class="n">listen</span><span class="p">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>
</span><span class='line'><span class="n">listen</span><span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="mo">0666</span>
</span><span class='line'><span class="n">user</span> <span class="o">=</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>
</span><span class='line'><span class="n">group</span> <span class="o">=</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#listen = 127.0.0.1:9000  </span>
</span><span class='line'><span class="n">listen</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span>
</span><span class='line'><span class="n">pid</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">pid</span>
</span><span class='line'>
</span><span class='line'><span class="n">error_log</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">log</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create and modify the startup script</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cp</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="mf">5.3.9</span><span class="o">/</span><span class="n">sapi</span><span class="o">/</span><span class="n">fpm</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="k">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span>
</span><span class='line'><span class="n">chmod</span> <span class="mi">755</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span>
</span><span class='line'><span class="n">update</span><span class="o">-</span><span class="n">rc</span><span class="p">.</span><span class="n">d</span> <span class="o">-</span><span class="n">f</span> <span class="n">php</span><span class="o">-</span><span class="n">fpm</span> <span class="n">defaults</span>
</span><span class='line'>
</span><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span>
</span><span class='line'><span class="n">prefix</span><span class="o">=</span>
</span><span class='line'><span class="n">exec_prefix</span><span class="o">=</span>
</span><span class='line'>
</span><span class='line'><span class="n">php</span><span class="err">\</span><span class="n">_fpm</span><span class="err">\</span><span class="n">_BIN</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span>
</span><span class='line'><span class="n">php</span><span class="err">\</span><span class="n">_fpm</span><span class="err">\</span><span class="n">_CONF</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">php</span><span class="err">\</span><span class="n">_fpm</span><span class="err">\</span><span class="n">_PID</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">pid</span>
</span><span class='line'>
</span><span class='line'><span class="n">service</span> <span class="n">php</span><span class="o">-</span><span class="n">fpm</span> <span class="n">start</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Nginx Installation</strong><br/>
Download, Configure and Install Nginx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//nginx.org/download/nginx-1.0.10.tar.gz  </span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">nginx</span><span class="o">-</span><span class="mf">1.0.10</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Some preperations to before building Nginx</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="p">.</span><span class="n">log</span>
</span><span class='line'><span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">access</span><span class="p">.</span><span class="n">log</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Build and Install Nginx</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="n">nginx</span><span class="o">-</span><span class="mf">1.0.10</span>
</span><span class='line'><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">conf</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="err">\</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">sbin</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span> <span class="err">\</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">with</span><span class="o">-</span><span class="n">http</span><span class="err">\</span><span class="n">_ssl</span><span class="err">\</span><span class="n">_module</span> <span class="err">\</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">error</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="p">.</span><span class="n">log</span>
</span><span class='line'>
</span><span class='line'><span class="n">make</span>
</span><span class='line'><span class="n">make</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Test Nginx and PHP Installation</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&lt;?</span><span class="n">php</span> <span class="n">echo</span> <span class="n">phpinfo</span><span class="p">();</span> <span class="o">?&gt;&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span><span class="o">/</span><span class="n">phpinfo</span><span class="p">.</span><span class="n">php</span>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>Use your browser to access <a href="http://localhost/phpinfo.php">http://localhost/phpinfo.php</a></p>

<p><strong>Configure Nginx to start your Site</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">cp</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">orig</span>
</span><span class='line'><span class="n">vi</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="err">\#</span> <span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/*</span><span class="p">.</span><span class="n">conf</span><span class="p">;</span>
</span><span class='line'><span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/*</span><span class="p">.</span><span class="n">conf</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#For additional security add the following at the bottom of your nginx.conf. Make sure you close the brackets properly. </span>
</span><span class='line'>
</span><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">cp</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">lessSecure</span>
</span><span class='line'><span class="n">vi</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="err">\#</span> <span class="n">NOTE</span><span class="o">:</span> <span class="n">Nginx</span> <span class="k">default</span> <span class="n">keepalive_timeout</span> <span class="n">might</span> <span class="n">currently</span> <span class="n">be</span> <span class="n">set</span><span class="p">.</span> <span class="n">Comment</span> <span class="n">out</span> <span class="n">the</span> <span class="k">default</span> <span class="n">and</span> <span class="n">use</span> <span class="n">the</span> <span class="n">below</span> <span class="n">setting</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Security</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="cp">#Start: Size Limits &amp; Buffer Overflows  </span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_body</span><span class="err">\</span><span class="n">_buffer_size</span> <span class="mi">1</span><span class="n">K</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_header</span><span class="err">\</span><span class="n">_buffer_size</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_max</span><span class="err">\</span><span class="n">_body_size</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">large</span><span class="err">\</span><span class="n">_client</span><span class="err">\</span><span class="n">_header_buffers</span> <span class="mi">2</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Start: Timeouts  </span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_body</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_header</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="n">keepalive_timeout</span> <span class="mi">5</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'><span class="n">send_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Store session states in zone slimits &amp;#8211; 32,000 sessions with 32 bytes/session/1m  </span>
</span><span class='line'><span class="n">limit</span><span class="err">\</span><span class="n">_zone</span> <span class="n">slimits</span> <span class="err">$</span><span class="n">binary</span><span class="err">\</span><span class="n">_remote_addr</span> <span class="mi">5</span><span class="n">m</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Restricts</span> <span class="n">connections</span> <span class="n">from</span> <span class="n">a</span> <span class="n">single</span> <span class="n">ip</span> <span class="n">address</span>
</span><span class='line'><span class="n">limit_conn</span> <span class="n">slimits</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configure FastCGI Paramaters</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">fastcgi_params</span>
</span><span class='line'><span class="err">\#</span> <span class="n">Added</span> <span class="n">by</span> <span class="n">Mike</span><span class="o">:</span> <span class="n">avoid</span> <span class="n">random</span> <span class="mi">503</span> <span class="n">errors</span> <span class="n">from</span> <span class="n">nginx</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_connect</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">60</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_send</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">180</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_read</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">180</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_buffer</span><span class="err">\</span><span class="n">_size</span> <span class="mi">128</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi_buffers</span> <span class="mi">4</span> <span class="mi">256</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_busy</span><span class="err">\</span><span class="n">_buffers_size</span> <span class="mi">256</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_temp</span><span class="err">\</span><span class="n">_file</span><span class="err">\</span><span class="n">_write</span><span class="err">\</span><span class="n">_size</span> <span class="mi">256</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_intercept</span><span class="err">\</span><span class="n">_errors</span> <span class="n">on</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Create some configuration directories. This is where you drop Site files</strong><br/>
# Make sure the following directories exist. If not, create them</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="n">sites</span><span class="o">-</span><span class="n">available</span>
</span><span class='line'><span class="n">mkdir</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Remove the default Site if you like. </strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">rm</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="k">default</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Create your Site (VirtualHost)</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">wordpress</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="err">\#</span> <span class="n">Upstream</span> <span class="n">to</span> <span class="n">abstract</span> <span class="n">backend</span> <span class="n">connection</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">php</span>
</span><span class='line'><span class="n">upstream</span> <span class="n">php</span> <span class="p">{</span>
</span><span class='line'><span class="n">server</span> <span class="n">unix</span><span class="o">:/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="p">;</span>
</span><span class='line'><span class="cp">#server 127.0.0.1:9000;  </span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">server</span> <span class="p">{</span>
</span><span class='line'><span class="err">\##</span> <span class="n">Your</span> <span class="n">website</span> <span class="n">name</span> <span class="n">goes</span> <span class="n">here</span><span class="p">.</span>
</span><span class='line'><span class="n">server_name</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">;</span>
</span><span class='line'><span class="err">\##</span> <span class="n">Your</span> <span class="n">only</span> <span class="n">path</span> <span class="n">reference</span><span class="p">.</span>
</span><span class='line'><span class="n">root</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span><span class="p">;</span>
</span><span class='line'><span class="err">\##</span> <span class="n">This</span> <span class="n">should</span> <span class="n">be</span> <span class="k">in</span> <span class="n">your</span> <span class="n">http</span> <span class="n">block</span> <span class="n">and</span> <span class="k">if</span> <span class="n">it</span> <span class="n">is</span><span class="p">,</span> <span class="n">it</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span><span class="n">s</span> <span class="n">not</span> <span class="n">needed</span> <span class="n">here</span><span class="p">.</span>
</span><span class='line'><span class="n">index</span> <span class="n">index</span><span class="p">.</span><span class="n">php</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">access_log</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="n">access</span><span class="p">.</span><span class="n">log</span><span class="p">;</span>
</span><span class='line'><span class="n">error_log</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">example</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="n">log</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_intercept</span><span class="err">\</span><span class="n">_errors</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">=</span> <span class="o">/</span><span class="n">favicon</span><span class="p">.</span><span class="n">ico</span> <span class="p">{</span>
</span><span class='line'><span class="n">log</span><span class="err">\</span><span class="n">_not</span><span class="err">\</span><span class="n">_found</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'><span class="n">access_log</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">=</span> <span class="o">/</span><span class="n">robots</span><span class="p">.</span><span class="n">txt</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#allow all;  </span>
</span><span class='line'><span class="n">log</span><span class="err">\</span><span class="n">_not</span><span class="err">\</span><span class="n">_found</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'><span class="n">access_log</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
</span><span class='line'><span class="err">\#</span> <span class="n">This</span> <span class="n">is</span> <span class="n">cool</span> <span class="n">because</span> <span class="n">no</span> <span class="n">php</span> <span class="n">is</span> <span class="n">touched</span> <span class="k">for</span> <span class="k">static</span> <span class="n">content</span>
</span><span class='line'><span class="n">try_files</span> <span class="err">$</span><span class="n">uri</span> <span class="err">$</span><span class="n">uri</span><span class="o">/</span> <span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">php</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">~</span> <span class="err">\</span><span class="p">.</span><span class="n">php</span><span class="err">$</span> <span class="p">{</span>
</span><span class='line'><span class="cp">#NOTE: You should have &amp;#8220;cgi.fix_pathinfo = 0;&amp;#8221; in php.ini  </span>
</span><span class='line'><span class="n">include</span> <span class="n">fastcgi</span><span class="p">.</span><span class="n">conf</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi</span><span class="err">\</span><span class="n">_intercept</span><span class="err">\</span><span class="n">_errors</span> <span class="n">on</span><span class="p">;</span>
</span><span class='line'><span class="n">fastcgi_pass</span> <span class="n">php</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Caching</span><span class="o">:</span> <span class="n">the</span> <span class="n">following</span> <span class="n">files</span> <span class="n">can</span> <span class="n">be</span> <span class="n">cached</span> <span class="n">by</span> <span class="n">the</span> <span class="n">browser</span>
</span><span class='line'><span class="n">location</span> <span class="o">~*</span> <span class="err">\</span><span class="p">.(</span><span class="n">js</span><span class="o">|</span><span class="n">css</span><span class="o">|</span><span class="n">png</span><span class="o">|</span><span class="n">jpg</span><span class="o">|</span><span class="n">jpeg</span><span class="o">|</span><span class="n">gif</span><span class="o">|</span><span class="n">ico</span><span class="p">)</span><span class="err">$</span> <span class="p">{</span>
</span><span class='line'><span class="n">expires</span> <span class="n">max</span><span class="p">;</span>
</span><span class='line'><span class="n">log</span><span class="err">\</span><span class="n">_not</span><span class="err">\</span><span class="n">_found</span> <span class="n">off</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">~</span> <span class="o">/</span><span class="err">\</span><span class="p">.</span> <span class="p">{</span> <span class="n">access</span><span class="err">\</span><span class="n">_log</span> <span class="n">off</span><span class="p">;</span> <span class="n">log</span><span class="err">\</span><span class="n">_not_found</span> <span class="n">off</span><span class="p">;</span> <span class="n">deny</span> <span class="n">all</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="n">location</span> <span class="o">~</span> <span class="o">~</span><span class="err">$</span> <span class="p">{</span> <span class="n">access</span><span class="err">\</span><span class="n">_log</span> <span class="n">off</span><span class="p">;</span> <span class="n">log</span><span class="err">\</span><span class="n">_not_found</span> <span class="n">off</span><span class="p">;</span> <span class="n">deny</span> <span class="n">all</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#For additional security add the following the end of your site configuration file. This should be added above the &amp;#8220;Location&amp;#8221; Directive. Make sure you close the brackets properly.  </span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Security</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Only</span> <span class="n">requests</span> <span class="n">to</span> <span class="n">m</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="n">are</span> <span class="n">allowed</span> <span class="err">#</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">host</span> <span class="o">!~</span> <span class="o">^</span><span class="p">(</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">|</span><span class="n">m</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">)</span><span class="err">$</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">444</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Only allow these request methods  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">request_method</span> <span class="o">!~</span> <span class="o">^</span><span class="p">(</span><span class="n">GET</span><span class="o">|</span><span class="n">HEAD</span><span class="o">|</span><span class="n">POST</span><span class="p">)</span><span class="err">$</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">444</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Block download agents  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">http</span><span class="err">\</span><span class="n">_user</span><span class="err">\</span><span class="n">_agent</span> <span class="o">~*</span> <span class="n">LWP</span><span class="o">::</span><span class="n">Simple</span><span class="o">|</span><span class="n">BBBike</span><span class="o">|</span><span class="n">wget</span><span class="o">|</span><span class="n">Baiduspider</span><span class="o">|</span><span class="n">Jullo</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Block some robots  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">http</span><span class="err">\</span><span class="n">_user</span><span class="err">\</span><span class="n">_agent</span> <span class="o">~*</span> <span class="n">msnbot</span><span class="o">|</span><span class="n">scrapbot</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Deny certain Referers  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="err">$</span><span class="n">http_referer</span> <span class="o">~*</span> <span class="p">(</span><span class="n">babes</span><span class="o">|</span><span class="n">forsale</span><span class="o">|</span><span class="n">girl</span><span class="o">|</span><span class="n">jewelry</span><span class="o">|</span><span class="n">love</span><span class="o">|</span><span class="n">nudit</span><span class="o">|</span><span class="n">organic</span><span class="o">|</span><span class="n">poker</span><span class="o">|</span><span class="n">porn</span><span class="o">|</span><span class="n">sex</span><span class="o">|</span><span class="n">teen</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Enable your new site</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span>
</span><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="p">..</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">wordpress</span><span class="p">.</span><span class="n">conf</span> <span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Modify Nginx init with the new installation PATH</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="err">\#</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">following</span> <span class="n">to</span> <span class="n">PATH</span>
</span><span class='line'><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">nginx</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Update Site permissions</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Start/restart your Nginx Service</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">service</span> <span class="n">nginx</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>WordPress Installation</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//wordpress.org/latest.tar.gz  </span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">latest</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span><span class='line'>
</span><span class='line'><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span>
</span><span class='line'><span class="n">mv</span> <span class="n">wordpress</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span>
</span><span class='line'><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Create a WordPress database and user</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span>
</span><span class='line'><span class="n">CREATE</span> <span class="n">DATABASE</span> <span class="n">wordpress</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">GRANT</span> <span class="n">ALL</span> <span class="n">PRIVILEGES</span> <span class="n">ON</span> <span class="n">wordpress</span><span class="p">.</span><span class="o">*</span> <span class="n">TO</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">wordpressadmin</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;@</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="n">localhost</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="n">IDENTIFIED</span> <span class="n">BY</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">welcome</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;;</span>
</span><span class='line'><span class="n">FLUSH</span> <span class="n">PRIVILEGES</span><span class="p">;</span>
</span><span class='line'><span class="n">exit</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configuring WordPress and Initial Setup</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">wordpress</span>
</span><span class='line'><span class="n">cp</span> <span class="n">wp</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">sample</span><span class="p">.</span><span class="n">php</span> <span class="n">wp</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">php</span>
</span><span class='line'><span class="n">vi</span> <span class="n">wp</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">php</span>
</span><span class='line'><span class="n">define</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">DB_NAME</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;,</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">wordpress</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;);</span>
</span><span class='line'><span class="n">define</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">DB_USER</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;,</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">wordpressadmin</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;);</span>
</span><span class='line'><span class="n">define</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">DB_PASSWORD</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;,</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">welcome</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>To complete WordPress setup visit:</strong></p>

<p><a href="http://127.0.0.1">http://127.0.0.1</a></p>

<p>Note: If you have any database connection issues, you may have to use &#8220;127.0.0.1&#8243; for Database Host. You can either do this within the wp-config.php or once you visit the localhost URL. Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">define</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">DB_HOST</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;,</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span><span class="mf">127.0.0.1</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8242</span><span class="p">;);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Secure your Server</strong><br/>
Secure MySQL</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mysql</span><span class="err">\</span><span class="n">_secure</span><span class="err">\</span><span class="n">_installation</span>
</span></code></pre></td></tr></table></div></figure>


<p>Enable Firewall</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">ufw</span> <span class="n">allow</span> <span class="n">ssh</span>
</span><span class='line'><span class="n">ufw</span> <span class="n">allow</span> <span class="n">http</span>
</span><span class='line'><span class="n">ufw</span> <span class="n">allow</span> <span class="n">https</span>
</span><span class='line'><span class="n">ufw</span> <span class="n">allow</span> <span class="mi">9222</span><span class="o">/</span><span class="n">tcp</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create a regular user with sudo access</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">useradd</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span> <span class="n">mike</span>
</span><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">group</span>
</span><span class='line'><span class="nl">sudo:</span><span class="n">x</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">mike</span>
</span><span class='line'><span class="nl">ssh:</span><span class="n">x</span><span class="o">:</span><span class="mi">107</span><span class="o">:</span><span class="n">mike</span>
</span></code></pre></td></tr></table></div></figure>


<p>Disable ROOT Login</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">securetty</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">securetty</span><span class="p">.</span><span class="n">orig</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">securetty</span>
</span></code></pre></td></tr></table></div></figure>


<p>Secure SSH and Limit access</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span>
</span><span class='line'><span class="n">Port</span> <span class="mi">9222</span>
</span><span class='line'><span class="n">PermitRootLogin</span> <span class="n">no</span>
</span><span class='line'><span class="n">StrictModes</span> <span class="n">yes</span>
</span><span class='line'><span class="n">IgnoreRhosts</span> <span class="n">yes</span>
</span><span class='line'><span class="n">HostbasedAuthentication</span> <span class="n">no</span>
</span><span class='line'><span class="n">RhostsRSAAuthentication</span> <span class="n">no</span>
</span><span class='line'><span class="n">X11Forwarding</span> <span class="n">no</span>
</span><span class='line'><span class="n">UsePAM</span> <span class="n">no</span>
</span><span class='line'><span class="n">UseDNS</span> <span class="n">no</span>
</span><span class='line'><span class="n">AllowGroups</span> <span class="n">ssh</span>
</span><span class='line'>
</span><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">ssh</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>


<p>Disable control-alt-delete</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">/</span><span class="n">control</span><span class="o">-</span><span class="n">alt</span><span class="o">-</span><span class="n">delete</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="cp">#exec shutdown -r now &amp;#8220;Control-Alt-Delete pressed&amp;#8221;  </span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify and secure kernel</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="cp">#####################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Kernel</span> <span class="n">Modifications</span> <span class="err">#</span>
</span><span class='line'><span class="cp">#####################################</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Controls</span> <span class="n">the</span> <span class="n">use</span> <span class="n">of</span> <span class="n">TCP</span> <span class="n">syncookies</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">tcp</span><span class="err">\</span><span class="n">_synack</span><span class="err">\</span><span class="n">_retries</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Don</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span><span class="n">t</span> <span class="n">Pass</span> <span class="n">Traffic</span> <span class="n">Between</span> <span class="n">Networks</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">all</span><span class="p">.</span><span class="n">send_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">send_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Don</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span><span class="n">t</span> <span class="n">Accept</span> <span class="n">Redirects</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">all</span><span class="p">.</span><span class="n">accept_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">all</span><span class="p">.</span><span class="n">secure_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">accept_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">secure_redirects</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Log</span> <span class="n">spoofed</span><span class="p">,</span> <span class="n">Source</span> <span class="n">Routed</span><span class="p">,</span> <span class="n">and</span> <span class="n">Redirect</span> <span class="n">Packets</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">all</span><span class="p">.</span><span class="n">log_martians</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Enable</span> <span class="n">Source</span> <span class="n">Route</span> <span class="n">Filtering</span>
</span><span class='line'><span class="n">net</span><span class="p">.</span><span class="n">ipv4</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">all</span><span class="p">.</span><span class="n">rp_filter</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p># The above will take effect on the next reboot</p>

<p>Configure NTP</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ntp</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">server</span> <span class="n">pool</span><span class="p">.</span><span class="n">ntp</span><span class="p">.</span><span class="n">org</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Configure Cisco WebVPN to use a Signed Certificate]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/01/18/configure-cisco-webvpn-to-use-a-signed-certificate/"/>
    <updated>2012-01-18T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/01/18/configure-cisco-webvpn-to-use-a-signed-certificate</id>
    <content type="html"><![CDATA[<p>If you like to install a Signed Certificate on your cisco Router&#8230;</p>

<ol>
<li>Create a new CSR on Test IIS Server</li>
<li>Submit CSR to CA</li>
<li>Once Signed/Generated, download the newly generated PKCS12 certificate and import to IIS</li>
<li>Export the new certificate via MMC<br/>
<em>   &#8211; Export </em>.example.com certificate from Personal Certificate with key<em><br/>
</em>   &#8211; Include all certificates in the path (CA, Intermediate)*</li>
<li>Place the exported .pfx file onto a tftp server</li>
<li>On the Cisco Router:</li>
</ol>


<!--more-->




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">crypto</span> <span class="n">pki</span> <span class="n">import</span> <span class="n">ExampleWildcard</span><span class="o">-</span><span class="n">Crt</span> <span class="n">pkcs12</span> <span class="n">tftp</span><span class="o">:</span><span class="c1">//10.10.10.65/certificate_file  </span>
</span><span class='line'><span class="o">!</span><span class="n">Yes</span> <span class="n">to</span> <span class="n">all</span>
</span></code></pre></td></tr></table></div></figure>


<p>Updated the WebVPN configuration to use the new certificate:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">webvpn</span> <span class="n">gateway</span> <span class="n">VTX</span><span class="o">-</span><span class="n">Admins</span>
</span><span class='line'><span class="n">ssl</span> <span class="n">trustpoint</span> <span class="n">ExampleWildcard</span><span class="o">-</span><span class="n">Crt</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Install and Configure Nginx+Django+uWSGI on Ubuntu 10.04 LTS]]></title>
    <link href="http://mmoghadas.github.io/blog/2012/01/08/install-and-configure-nginxdjangouwsgi-on-ubuntu-10-04-lts/"/>
    <updated>2012-01-08T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2012/01/08/install-and-configure-nginxdjangouwsgi-on-ubuntu-10-04-lts</id>
    <content type="html"><![CDATA[<p>GettingNginx+Django+uWSGI to work together via repositories is fairly easy. The same goes for getting this setup working from source.. You just have to have good instructions. Here&#8217;s a very simple and quick install guide.</p>

<p>Install packages required to build and install from source. Also, Nginx is installed to take care of some of the prerequisites and to install configuration files.</p>

<!--more-->




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">supervisor</span> <span class="n">python</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span> <span class="n">nginx</span> <span class="n">libxml2</span><span class="o">-</span><span class="n">dev</span> <span class="n">libpcre3</span> <span class="n">libpcre3</span><span class="o">-</span><span class="n">dev</span> <span class="n">unzip</span>
</span></code></pre></td></tr></table></div></figure>


<p>Remove and purge Nginx installation. Configuration and startup files are left behind.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">remove</span> <span class="n">nginx</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="n">nginx</span>
</span></code></pre></td></tr></table></div></figure>


<p>Install Django</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span>
</span></code></pre></td></tr></table></div></figure>


<p>If using memcached, Install the memcached client</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">easy_install</span> <span class="n">python</span><span class="o">-</span><span class="n">memcached</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create the install structure and download/extract the required files</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">installs</span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//projects.unbit.it/downloads/uwsgi-0.9.9.2.tar.gz  </span>
</span><span class='line'><span class="n">wget</span> <span class="n">http</span><span class="o">:</span><span class="c1">//nginx.org/download/nginx-1.0.10.tar.gz  </span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">nginx</span><span class="o">-</span><span class="mf">1.0.10</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span><span class='line'><span class="n">tar</span> <span class="n">zxvf</span> <span class="n">uwsgi</span><span class="o">-</span><span class="mf">0.9.9.2</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
</span></code></pre></td></tr></table></div></figure>


<p>Build and Install uWSGI</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="n">uwsgi</span><span class="o">-</span><span class="mf">0.9.9.2</span>
</span><span class='line'><span class="n">make</span>
</span><span class='line'><span class="n">cp</span> <span class="n">uwsgi</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span>
</span></code></pre></td></tr></table></div></figure>


<p>Some preperations to before building Nginx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="p">.</span><span class="n">log</span>
</span><span class='line'><span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">access</span><span class="p">.</span><span class="n">log</span>
</span></code></pre></td></tr></table></div></figure>


<p>Build and Install Nginx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="p">..</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="mf">1.0.10</span>
</span><span class='line'><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">conf</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="err">\</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">sbin</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span> <span class="err">\</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">error</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">path</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">error</span><span class="p">.</span><span class="n">log</span>
</span><span class='line'><span class="n">make</span>
</span><span class='line'><span class="n">make</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create structure and build your DEMO Django project</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span>
</span><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span>
</span><span class='line'><span class="n">django</span><span class="o">-</span><span class="n">admin</span><span class="p">.</span><span class="n">py</span> <span class="n">startproject</span> <span class="n">MobileTicketSales</span>
</span><span class='line'><span class="n">cd</span> <span class="n">MobileTicketSales</span>
</span><span class='line'><span class="n">vi</span> <span class="n">wsgi_app</span><span class="p">.</span><span class="n">py</span>
</span><span class='line'><span class="cp">#! /usr/bin/env python  </span>
</span><span class='line'><span class="n">import</span> <span class="n">sys</span>
</span><span class='line'><span class="n">import</span> <span class="n">os</span>
</span><span class='line'><span class="n">import</span> <span class="n">django</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">handlers</span><span class="p">.</span><span class="n">wsgi</span>
</span><span class='line'><span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;)</span>
</span><span class='line'><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="err">&#39;</span><span class="n">DJANGO</span><span class="err">\</span><span class="n">_SETTINGS</span><span class="err">\</span><span class="n">_MODULE</span><span class="err">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">MobileTicketSales</span><span class="p">.</span><span class="n">settings</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span>
</span><span class='line'><span class="n">application</span> <span class="o">=</span> <span class="n">django</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">handlers</span><span class="p">.</span><span class="n">wsgi</span><span class="p">.</span><span class="n">WSGIHandler</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>Configure init daemon to control your uWSGI application</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">/</span><span class="n">mobile</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">description</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">uWSGI</span> <span class="n">server</span> <span class="k">for</span> <span class="n">Project</span> <span class="n">Foo</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">start</span> <span class="n">on</span> <span class="n">runlevel</span> <span class="p">[</span><span class="mi">2345</span><span class="p">]</span>
</span><span class='line'><span class="n">stop</span> <span class="n">on</span> <span class="n">runlevel</span> <span class="p">[</span><span class="o">!</span><span class="mi">2345</span><span class="p">]</span>
</span><span class='line'><span class="n">respawn</span>
</span><span class='line'><span class="n">exec</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">uwsgi</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">socket</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">mobile</span><span class="p">.</span><span class="n">sock</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">chmod</span><span class="o">-</span><span class="n">socket</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">module</span> <span class="n">wsgi_app</span>
</span><span class='line'><span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">pythonpath</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span>
</span><span class='line'><span class="o">-</span><span class="n">p</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Start your uWSGI</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">initctl</span> <span class="n">reload</span><span class="o">-</span><span class="n">configuration</span>
</span><span class='line'><span class="n">service</span> <span class="n">mobile</span> <span class="n">start</span>
</span></code></pre></td></tr></table></div></figure>


<p>Configure Nginx to start your Site</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">cp</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">orig</span>
</span><span class='line'><span class="n">vi</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="err">\#</span> <span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/*</span><span class="p">.</span><span class="n">conf</span><span class="p">;</span>
</span><span class='line'><span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/*</span><span class="p">.</span><span class="n">conf</span><span class="p">;</span>
</span><span class='line'><span class="n">For</span> <span class="n">additional</span> <span class="n">security</span> <span class="n">add</span> <span class="n">the</span> <span class="n">following</span> <span class="n">to</span> <span class="n">your</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="n">cp</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">orig</span>
</span><span class='line'><span class="n">vi</span> <span class="n">nginx</span><span class="p">.</span><span class="n">conf</span>
</span></code></pre></td></tr></table></div></figure>


<p># You may also add the below section to secure Nginx a bit<br/>
# NOTE: Nginx default keepalive_timeout might currently be set. Comment out the default and use the below setting.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Security</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="cp">#Start: Size Limits &amp; Buffer Overflows  </span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_body</span><span class="err">\</span><span class="n">_buffer_size</span> <span class="mi">1</span><span class="n">K</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_header</span><span class="err">\</span><span class="n">_buffer_size</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_max</span><span class="err">\</span><span class="n">_body_size</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'><span class="n">large</span><span class="err">\</span><span class="n">_client</span><span class="err">\</span><span class="n">_header_buffers</span> <span class="mi">2</span> <span class="mi">1</span><span class="n">k</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Start: Timeouts  </span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_body</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="n">client</span><span class="err">\</span><span class="n">_header</span><span class="err">\</span><span class="n">_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="n">keepalive_timeout</span> <span class="mi">5</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'><span class="n">send_timeout</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Store session states in zone slimits &amp;#8211; 32,000 sessions with 32 bytes/session/1m  </span>
</span><span class='line'><span class="n">limit</span><span class="err">\</span><span class="n">_zone</span> <span class="n">slimits</span> <span class="err">$</span><span class="n">binary</span><span class="err">\</span><span class="n">_remote_addr</span> <span class="mi">5</span><span class="n">m</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="err">\#</span> <span class="n">Restricts</span> <span class="n">connections</span> <span class="n">from</span> <span class="n">a</span> <span class="n">single</span> <span class="n">ip</span> <span class="n">address</span>
</span><span class='line'><span class="n">limit_conn</span> <span class="n">slimits</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create some configuration directories. This is where you drop Site files<br/>
# Make sure the following directories exist. If not, create them</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="n">sites</span><span class="o">-</span><span class="n">available</span>
</span><span class='line'><span class="n">mkdir</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span>
</span></code></pre></td></tr></table></div></figure>


<p>Remove the default Site if you like. If you plan to leave this site alone, you must configure your uWSGI applicaiton to run on a alternative port</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">rm</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="k">default</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create your Site (VirtualHost)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">mobile</span><span class="p">.</span><span class="n">conf</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Server</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="n">server</span> <span class="p">{</span>
</span><span class='line'><span class="n">listen</span> <span class="mi">80</span><span class="p">;</span>
</span><span class='line'><span class="n">server_name</span> <span class="n">m</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Location</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
</span><span class='line'><span class="n">uwsgi_pass</span> <span class="n">unix</span><span class="o">:</span><span class="c1">//var/run/mobile.sock;  </span>
</span><span class='line'><span class="n">include</span> <span class="n">uwsgi_params</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">/</span><span class="k">static</span><span class="o">/</span> <span class="p">{</span>
</span><span class='line'><span class="n">alias</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="k">static</span><span class="o">/</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">/</span><span class="n">s</span><span class="o">/</span> <span class="p">{</span>
</span><span class='line'><span class="n">alias</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="k">static</span><span class="o">/</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">location</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span> <span class="p">{</span>
</span><span class='line'><span class="n">alias</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span><span class="o">/</span><span class="n">MobileTicketSales</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="n">For</span> <span class="n">additional</span> <span class="n">security</span> <span class="n">add</span> <span class="n">the</span> <span class="n">following</span> <span class="n">to</span> <span class="n">your</span> <span class="n">site</span> <span class="n">configuration</span> <span class="n">file</span><span class="p">.</span> <span class="n">This</span> <span class="n">should</span> <span class="n">be</span> <span class="n">added</span> <span class="n">above</span> <span class="n">the</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Location</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="n">Directive</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Security</span> <span class="n">Directives</span> <span class="err">#</span>
</span><span class='line'><span class="cp">########################################################  </span>
</span><span class='line'><span class="err">\#</span> <span class="n">Only</span> <span class="n">requests</span> <span class="n">to</span> <span class="n">m</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="n">are</span> <span class="n">allowed</span> <span class="err">#</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">host</span> <span class="o">!~</span> <span class="o">^</span><span class="p">(</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">|</span><span class="n">m</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">)</span><span class="err">$</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">444</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Only allow these request methods  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">request_method</span> <span class="o">!~</span> <span class="o">^</span><span class="p">(</span><span class="n">GET</span><span class="o">|</span><span class="n">HEAD</span><span class="o">|</span><span class="n">POST</span><span class="p">)</span><span class="err">$</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">444</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Block download agents  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">http</span><span class="err">\</span><span class="n">_user</span><span class="err">\</span><span class="n">_agent</span> <span class="o">~*</span> <span class="n">LWP</span><span class="o">::</span><span class="n">Simple</span><span class="o">|</span><span class="n">BBBike</span><span class="o">|</span><span class="n">wget</span><span class="o">|</span><span class="n">Baiduspider</span><span class="o">|</span><span class="n">Jullo</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Block some robots  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">http</span><span class="err">\</span><span class="n">_user</span><span class="err">\</span><span class="n">_agent</span> <span class="o">~*</span> <span class="n">msnbot</span><span class="o">|</span><span class="n">scrapbot</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Deny certain Referers  </span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="err">$</span><span class="n">http_referer</span> <span class="o">~*</span> <span class="p">(</span><span class="n">babes</span><span class="o">|</span><span class="n">forsale</span><span class="o">|</span><span class="n">girl</span><span class="o">|</span><span class="n">jewelry</span><span class="o">|</span><span class="n">love</span><span class="o">|</span><span class="n">nudit</span><span class="o">|</span><span class="n">organic</span><span class="o">|</span><span class="n">poker</span><span class="o">|</span><span class="n">porn</span><span class="o">|</span><span class="n">sex</span><span class="o">|</span><span class="n">teen</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'><span class="k">return</span> <span class="mi">403</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Enable your new Site</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">cd</span> <span class="n">sites</span><span class="o">-</span><span class="n">enabled</span>
</span><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="p">..</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">mobile</span><span class="p">.</span><span class="n">conf</span> <span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify Nginx init with the new installation PATH</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">nginx</span>
</span><span class='line'><span class="err">\#</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">following</span> <span class="n">to</span> <span class="n">PATH</span>
</span><span class='line'><span class="o">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">nginx</span>
</span></code></pre></td></tr></table></div></figure>


<p>Update Site permissions</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">mobile</span>
</span></code></pre></td></tr></table></div></figure>


<p>Start/restart your Nginx Service</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">service</span> <span class="n">nginx</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Updating VMware ESXI 5.0 with latest patches]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/12/27/updating-vmware-esxi-5-0-with-latest-patches/"/>
    <updated>2011-12-27T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/12/27/updating-vmware-esxi-5-0-with-latest-patches</id>
    <content type="html"><![CDATA[<p>VMware was nice enough to remove the pretty &#8220;GUI&#8221; Update Utility after ESXi version 4.1. So now you&#8217;ll need to do bunch of commands to get your VMware Host Updated. Here&#8217;s how:</p>

<p><strong>What you&#8217;ll need</strong><br/>
1. Install VMware CLI on your machine. Once this tool is installed the required utilities are located in &#8220;<strong>C:Program Files (x86)VMwareVMware vSphere CLIbin</strong>&#8220;. Add this location to your PATH to make life easier. (The below instructions assume you&#8217;ve done this)</p>

<!--more-->


<ol>
<li><p>ESXi Patch you want to apply downloaded from VMware</p></li>
<li><p>SSH Enabled on the ESXi Host(s)<br/>
<strong>How to Patch things up</strong></p></li>
<li><p>Copy your patch to the ESXi Host. You can use scp/ssh to do this</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">scp</span> <span class="n">ESXi500</span><span class="o">-</span><span class="mf">201111001.</span><span class="n">zip</span> <span class="n">root</span><span class="mf">@10.10.10.206</span><span class="o">:/</span><span class="n">vmfs</span><span class="o">/</span><span class="n">volumes</span><span class="o">/</span><span class="n">datastore1</span><span class="o">/</span>
</span></code></pre></td></tr></table></div></figure>


<p>
2. Force your EXSi to enter Maintenance Mode</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">vicfg</span><span class="o">-</span><span class="n">hostops</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">operation</span> <span class="n">enter</span>
</span></code></pre></td></tr></table></div></figure>


<p>
3. Verify Maintenance Mode</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">vicfg</span><span class="o">-</span><span class="n">hostops</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">operation</span> <span class="n">info</span>
</span></code></pre></td></tr></table></div></figure>


<p>
&#8211;OR&#8211;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">vicfg</span><span class="o">-</span><span class="n">hostops</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">operation</span> <span class="n">info</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">In</span> <span class="n">Maintenance</span> <span class="n">Mode</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>
4. Update VM Host with your new patches</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">esxcli</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="n">software</span> <span class="n">vib</span> <span class="n">update</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">depot</span><span class="o">=/</span><span class="n">vmfs</span><span class="o">/</span><span class="n">volumes</span><span class="o">/</span><span class="n">datastore1</span><span class="o">/</span><span class="n">ESXi500</span><span class="o">-</span><span class="mf">201111001.</span><span class="n">zip</span>
</span></code></pre></td></tr></table></div></figure>


<p>
5. Reboot VM Host</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">vicfg</span><span class="o">-</span><span class="n">hostops</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">operation</span> <span class="n">reboot</span>
</span></code></pre></td></tr></table></div></figure>


<p>
6. Exit Maintenance Mode</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'> <span class="n">vicfg</span><span class="o">-</span><span class="n">hostops</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">server</span><span class="o">=</span><span class="mf">10.10.10.206</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">username</span><span class="o">=</span><span class="n">root</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">password</span><span class="o">=</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">operation</span> <span class="n">exit</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Django, WSGI, Apache2 on Ubuntu 10.04 LTS]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/12/04/django-wsgi-apache2-on-ubuntu-10-04-lts/"/>
    <updated>2011-12-04T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/12/04/django-wsgi-apache2-on-ubuntu-10-04-lts</id>
    <content type="html"><![CDATA[<p>Install Apache2</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">apache2</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<p>Install MOD_WSGI</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libapache2</span><span class="o">-</span><span class="n">mod</span><span class="o">-</span><span class="n">wsgi</span>
</span></code></pre></td></tr></table></div></figure>


<p>Install Python (Installed by default, but just in case)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span>
</span></code></pre></td></tr></table></div></figure>


<p>Install Python Setup Tools</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span>
</span></code></pre></td></tr></table></div></figure>


<p>Install Django</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span>
</span><span class='line'><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Keep IIS Logs Clean and keep only a week worth of logs]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/11/18/keep-iis-logs-clean-and-keep-only-a-week-worth-of-logs/"/>
    <updated>2011-11-18T00:00:00-08:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/11/18/keep-iis-logs-clean-and-keep-only-a-week-worth-of-logs</id>
    <content type="html"><![CDATA[<p>Webserver logs can add up and eventually fill up your entire disk if not mananged properly. Windows and IIS don&#8217;t exactly give you flexible options to manage logs either. So what to do? Here&#8217;s simple solution. We&#8217;re going to create couple of scripts and kick off a Task to purge old logs.</p>

<p>Lets create a folder to store the scripts</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mkdir</span> <span class="n">C</span><span class="o">:</span><span class="n">scripts</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<p>Create a batch file to kick off a powershell script</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">notepad</span> <span class="n">C</span><span class="o">:</span><span class="n">scriptsDelete</span><span class="o">-</span><span class="n">Old</span><span class="o">-</span><span class="n">IIS</span><span class="o">-</span><span class="n">Logs</span><span class="p">.</span><span class="n">bat</span> <span class="err">#</span><span class="n">Add</span> <span class="n">the</span> <span class="n">below</span> <span class="n">line</span> <span class="n">to</span> <span class="n">the</span> <span class="p">.</span><span class="n">bat</span> <span class="n">file</span>
</span><span class='line'><span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> <span class="n">C</span><span class="o">:</span><span class="n">scriptsDelete</span><span class="o">-</span><span class="n">Old</span><span class="o">-</span><span class="n">IIS</span><span class="o">-</span><span class="n">Logs</span><span class="p">.</span><span class="n">ps1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lets create a powershell script that will clean up the logs and leave 7 days worth</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">notepad</span> <span class="n">C</span><span class="o">:</span><span class="n">scriptsDelete</span><span class="o">-</span><span class="n">Old</span><span class="o">-</span><span class="n">IIS</span><span class="o">-</span><span class="n">Logs</span><span class="p">.</span><span class="n">ps1</span> <span class="err">#</span><span class="n">Add</span> <span class="n">the</span> <span class="n">below</span> <span class="n">lines</span> <span class="n">to</span> <span class="n">the</span> <span class="p">.</span><span class="n">ps1</span> <span class="n">file</span>
</span><span class='line'><span class="err">$</span><span class="n">Path</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">C</span><span class="o">:</span><span class="n">inetpublogsLogFilesW3SVC1</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="err">$</span><span class="n">LogsToKeep</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="mi">7</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="err">$</span><span class="n">CurrentDate</span> <span class="o">=</span> <span class="n">Get</span><span class="o">-</span><span class="n">Date</span>
</span><span class='line'><span class="err">$</span><span class="n">DatetoDelete</span> <span class="o">=</span> <span class="err">$</span><span class="n">CurrentDate</span><span class="p">.</span><span class="n">AddDays</span><span class="p">(</span><span class="o">-</span><span class="err">$</span><span class="n">LogsToKeep</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">Get</span><span class="o">-</span><span class="n">ChildItem</span> <span class="err">$</span><span class="n">Path</span> <span class="o">-</span><span class="n">recurse</span> <span class="o">|</span> <span class="n">Where</span><span class="o">-</span><span class="n">Object</span> <span class="p">{</span> <span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">LastWriteTime</span> <span class="o">-</span><span class="n">lt</span> <span class="err">$</span><span class="n">DatetoDelete</span> <span class="p">}</span> <span class="o">|</span> <span class="n">Remove</span><span class="o">-</span><span class="n">Item</span>
</span></code></pre></td></tr></table></div></figure>


<p>Create a new Task via Task Scheduler and Check the following settings:<br/>
&ndash; Run whether user is logged on or not<br/>
&ndash; Run with highest privileges<br/>
&ndash; Action should be: Start a Program and pointing to &#8220;:scriptsDelete-Old-IIS-Logs.bat&#8221;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to monitor MySQL Replication]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/08/02/how-to-monitor-mysql-replication/"/>
    <updated>2011-08-02T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/08/02/how-to-monitor-mysql-replication</id>
    <content type="html"><![CDATA[<p>I have spent some time looking for a solution to monitor MySQL Replication with no lock. So I decided to figure something out myself rather than wasting more time or end up paying Oracle. Turns out the setup is actually very simple and can be easily setup with few lines of shell script and a monitoring tool that can produce alerts and graphs via SNMP Traps (PRTG in my case).</p>

<p><strong>What do you need?</strong><br/>
<em>Note: Make sure to update the below addresses</em><br/>
MySQL Master: 192.168.1.101<br/>
MySQL Slave: 192.168.1.102<br/>
SNMP Tools (snmptrap specifically)<br/>
Monitoring Server (I use PRTG): 192.168.1.116<br/>
Your shell script<br/>
A Replication client user must be created on both Master and Slave servers.</p>

<!--more-->


<p><strong>Where do you configure things?</strong><br/>
You can run the script/cronjob from either Master or the Slave. I configured the job on the Slave server keep the load off the Master.</p>

<p><strong>Step1:</strong> Configure Replication. Im not going to cover replication here. Plenty of articles available on how to configure replication</p>

<p><strong>Step2:</strong> Create the Replication Client user on Master and Slave. Run the following command on both servers. Make sure to grant REPLICATION CLIENT privilege only.</p>

<p><em>Note: replace the *<strong>*</strong>*</em><em>** with your password for the new account.</em></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">GRANT</span> <span class="n">REPLICATION</span> <span class="n">CLIENT</span> <span class="n">ON</span> <span class="err">\</span><span class="o">*</span><span class="p">.</span><span class="err">\</span><span class="o">*</span> <span class="n">TO</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">rep</span><span class="o">-</span><span class="n">client</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;@</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span><span class="mf">192.168.1.101</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8242</span><span class="p">;</span> <span class="n">IDENTIFIED</span> <span class="n">BY</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">*****&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Step3:</strong> Test your newly created accounts permissions. Logon to the Slave server and run the following commands Master and the Slave:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="n">p</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">*****</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.101</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">master</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="n">p</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">*****</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.102</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">slave</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Step4:</strong> Create the following script</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">MySQL</span><span class="err">\</span><span class="n">_Replication</span><span class="err">\</span><span class="n">_Check</span>
</span><span class='line'><span class="cp">#!/bin/bash</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#MASTER Variables  </span>
</span><span class='line'><span class="n">M_Position</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.101</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">master</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Position</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`  </span>
</span><span class='line'><span class="n">M_File</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.101</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">master</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">File</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#SLAVE Variables  </span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Exec</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_Pos</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.102</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">slave</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Exec</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log_Pos</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`  </span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_File</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.102</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">slave</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_File</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="o">/</span><span class="n">Relay</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_File</span><span class="o">/</span><span class="n">d</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`  </span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Slave</span><span class="err">\</span><span class="n">_IO</span><span class="err">\</span><span class="n">_State</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.102</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">slave</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Slave</span><span class="err">\</span><span class="n">_IO_State</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`  </span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Seconds</span><span class="err">\</span><span class="n">_Behind</span><span class="err">\</span><span class="n">_Master</span><span class="o">=</span><span class="err">\`</span><span class="n">mysql</span> <span class="o">-</span><span class="n">urep</span><span class="o">-</span><span class="n">client</span> <span class="o">-</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">***</span><span class="err">\</span><span class="o">****</span><span class="err">\</span><span class="o">*</span> <span class="o">-</span><span class="n">h192</span><span class="mf">.168.1.102</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">show</span> <span class="n">slave</span> <span class="n">statusG</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">Seconds</span><span class="err">\</span><span class="n">_Behind_Master</span> <span class="o">|</span> <span class="n">sed</span> <span class="o">-</span><span class="n">e</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">s</span><span class="o">/</span><span class="p">[</span><span class="o">^:</span><span class="p">]</span><span class="err">\</span><span class="o">*:</span><span class="c1">//&amp;#8217;\`  </span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Slave</span><span class="err">\</span><span class="n">_IO</span><span class="err">\</span><span class="n">_StateString</span><span class="o">=</span><span class="err">\`</span><span class="n">echo</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Slave</span><span class="err">\</span><span class="n">_IO</span><span class="err">\</span><span class="n">_State</span><span class="err">\`</span>
</span><span class='line'><span class="n">S</span><span class="err">\</span><span class="n">_Slave</span><span class="err">\</span><span class="n">_IO_StateOK</span><span class="o">=&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span><span class="n">Waiting</span> <span class="k">for</span> <span class="n">master</span> <span class="n">to</span> <span class="n">send</span> <span class="n">event</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Replication Overall Status. Send SNMPTrap to Monitoring  </span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">[</span> <span class="s">&quot;$S\_Slave\_IO\_StateString&quot;</span> <span class="o">==</span> <span class="s">&quot;$S\_Slave\_IO\_StateOK&quot;</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">[</span> <span class="err">$</span><span class="n">M</span><span class="err">\</span><span class="n">_Position</span> <span class="o">-</span><span class="n">eq</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Exec</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_Pos</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">[</span> <span class="err">$</span><span class="n">M</span><span class="err">\</span><span class="n">_File</span> <span class="o">==</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_File</span> <span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">[</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Seconds</span><span class="err">\</span><span class="n">_Behind</span><span class="err">\</span><span class="n">_Master</span> <span class="o">-</span><span class="n">lt</span> <span class="mi">5</span> <span class="p">]</span>
</span><span class='line'><span class="n">then</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">is</span> <span class="n">running</span> <span class="n">fine</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8230</span><span class="p">;.</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">snmptrap</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">-</span><span class="n">c</span> <span class="n">ROpublic</span> <span class="mf">192.168.1.99</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="mf">1.11.12.13.14.15111</span> <span class="n">s</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">OK</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">BROKEN</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">snmptrap</span> <span class="o">-</span><span class="n">v</span> <span class="mi">1</span> <span class="o">-</span><span class="n">c</span> <span class="n">ROpublic</span> <span class="mf">192.168.1.99</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="mf">1.11.12.13.14.15111</span> <span class="n">s</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">Broken</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">fi</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Replication State Status  </span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Slave</span> <span class="n">IO</span> <span class="n">State</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Slave</span><span class="err">\</span><span class="n">_IO_StateString</span>
</span><span class='line'><span class="k">if</span> <span class="p">[</span> <span class="s">&quot;$S\_Slave\_IO\_StateString&quot;</span> <span class="o">==</span> <span class="s">&quot;$S\_Slave\_IO\_StateOK&quot;</span> <span class="p">]</span>
</span><span class='line'><span class="n">then</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">OK</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Replication</span> <span class="n">STOPPED</span><span class="o">!&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">fi</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Replication Log Files Status  </span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Master</span> <span class="n">Log</span> <span class="n">File</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">M_File</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Slave</span> <span class="n">Log</span> <span class="n">File</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log_File</span>
</span><span class='line'><span class="k">if</span> <span class="p">[</span> <span class="err">$</span><span class="n">M</span><span class="err">\</span><span class="n">_File</span> <span class="o">==</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_File</span> <span class="p">]</span>
</span><span class='line'><span class="n">then</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Log</span> <span class="n">Files</span><span class="o">:</span> <span class="n">OK</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Log</span> <span class="n">Files</span> <span class="n">DO</span> <span class="n">NOT</span> <span class="n">Match</span><span class="o">!&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">fi</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Replication Log Position Status  </span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Master</span> <span class="n">Position</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">M_Position</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Slave</span> <span class="n">Position</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Exec</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log</span><span class="err">\</span><span class="n">_Pos</span>
</span><span class='line'><span class="k">if</span> <span class="p">[</span> <span class="err">$</span><span class="n">M</span><span class="err">\</span><span class="n">_Position</span> <span class="o">-</span><span class="n">eq</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Exec</span><span class="err">\</span><span class="n">_Master</span><span class="err">\</span><span class="n">_Log_Pos</span> <span class="p">]</span>
</span><span class='line'><span class="n">then</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Position</span><span class="o">:</span> <span class="n">OK</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Slave</span> <span class="n">is</span> <span class="n">Behind</span><span class="o">!&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">fi</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#Slave Seconds Behind Master  </span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Slave</span> <span class="n">Seconds</span> <span class="n">Behind</span> <span class="n">Master</span><span class="o">:</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Seconds</span><span class="err">\</span><span class="n">_Behind_Master</span>
</span><span class='line'><span class="k">if</span> <span class="p">[</span> <span class="err">$</span><span class="n">S</span><span class="err">\</span><span class="n">_Seconds</span><span class="err">\</span><span class="n">_Behind_Master</span> <span class="o">-</span><span class="n">lt</span> <span class="mi">5</span> <span class="p">]</span>
</span><span class='line'><span class="n">then</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Acceptable</span><span class="o">:</span> <span class="nb">YES</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="n">echo</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="n">Acceptable</span><span class="o">:</span> <span class="nb">NO</span><span class="p">,</span> <span class="n">Slave</span> <span class="n">is</span> <span class="n">Way</span> <span class="n">Behind</span><span class="o">!&amp;</span><span class="err">#</span><span class="mi">8221</span><span class="p">;</span>
</span><span class='line'><span class="n">fi</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Step5:</strong> Create a cronjob to run your new script every 60 seconds. You can adjust this if you like.. All depends on how busy your database is.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">crontab</span> <span class="o">-</span><span class="n">e</span>
</span><span class='line'><span class="err">\#</span> <span class="n">MySQL</span> <span class="n">Replication</span> <span class="n">Check</span>
</span><span class='line'><span class="err">\</span><span class="o">*</span> <span class="err">\</span><span class="o">*</span> <span class="err">\</span><span class="o">*</span> <span class="err">\</span><span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">MySQL</span><span class="err">\</span><span class="n">_Replication</span><span class="err">\</span><span class="n">_Check</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Step6:</strong> Configure your monitoring to receive SNMPTraps from your slave (or where you are running your cronjob). The following is meant to be used with PRTG. You can configure other monitoring tools to received SNMP Traps as well.<br/>
&ndash; Logon to the Web Interface<br/>
&ndash; Devices<br/>
&ndash; Select your Probe<br/>
&ndash; Add Sensor<br/>
&ndash; Select or search for &#8220;SNMP Trap Receiver&#8221; and complete the following:<br/>
OID value: 1.11.12.13.14.15111<br/>
Sender: 192.168.1.102<br/>
Set sensor to &#8216;warning&#8217;/Message must include: Replication OK<br/>
Set sensor to &#8216;warning&#8217;/Message must not include: Replication Broken<br/>
Scanning Interval: 60 seconds</p>

<p><strong>Step7:</strong> Make sure you have SNMP Tools installed.<br/>
On Redhat:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">yum</span> <span class="n">install</span> <span class="n">net</span><span class="o">-</span><span class="n">snmp</span><span class="o">-</span><span class="n">utils</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to get PL2303 USB to Serial Driver to work on Mac OS X 10.7 (64bit)]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/19/how-to-get-pl2303-usb-to-serial-driver-to-work-on-mac-os-x-10-7-64bit/"/>
    <updated>2011-07-19T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/19/how-to-get-pl2303-usb-to-serial-driver-to-work-on-mac-os-x-10-7-64bit</id>
    <content type="html"><![CDATA[<p><strong>What you need</strong><br/>
File: osx-pl2303.kext.zip<br/>
Location: <a href="http://sourceforge.net/tracker/index.php?func=detail&#038;aid=2952982&#038;group_id=157692&#038;atid=804837" target="_blank"><a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=2952982&amp;group_id=157692&amp;atid=804837">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=2952982&amp;group_id=157692&amp;atid=804837</a></a></p>

<p><strong>How to get it working</strong><br/>
1. Download the above driver for your 64bit OSX<br/>
2. Unpack the driver<br/>
3. Copy osx-pl2303.kext to /System/Library/Extensions</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="o">~/</span><span class="n">osx</span><span class="o">-</span><span class="n">pl2303</span><span class="p">.</span><span class="n">kext</span> <span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Extensions</span><span class="o">/</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<ol>
<li>Load the driver</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">kextload</span> <span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Extensions</span><span class="o">/</span><span class="n">osx</span><span class="o">-</span><span class="n">pl2303</span><span class="p">.</span><span class="n">kext</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Plug your USB-to-Serial in</li>
<li>Test</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cu</span><span class="p">.</span><span class="n">PL2303</span><span class="o">-*</span>
</span><span class='line'><span class="n">or</span>
</span><span class='line'><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">tty</span><span class="p">.</span><span class="n">PL2303</span><span class="o">-*</span>
</span></code></pre></td></tr></table></div></figure>


<p>
7. If you see a device with above name, you have installed your driver successfully</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Upgrading Ubuntu 9.04 to 10.04 LTS]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/14/upgrading-ubuntu-9-04-to-10-04-lts/"/>
    <updated>2011-07-14T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/14/upgrading-ubuntu-9-04-to-10-04-lts</id>
    <content type="html"><![CDATA[<p>NOTE: Upgrading directly from 9.04 to 10.04 LTS is not possible. The proper upgrade path is 9.04 > 9.10 > 10.04.</p>

<p><strong>Upgrade 9.04 to 9.10 first</strong><br/>
1. Download and mount ubuntu-9.10-alternate-i386.iso<br/>
2. Mount your iso</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">loop</span> <span class="o">~/</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">9.10</span><span class="o">-</span><span class="n">alternate</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">cdrom</span>
</span><span class='line'><span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">loop</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">cdrom</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">cdrom</span> <span class="p">(</span><span class="k">if</span> <span class="n">your</span> <span class="n">burned</span> <span class="n">your</span> <span class="n">iso</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<ol>
<li>After mounting the iso, you can simply run this utility to upgrade to 9.10</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">cdrom</span><span class="o">/</span><span class="n">cdromupgrade</span>
</span></code></pre></td></tr></table></div></figure>


<p>
4. Select the following options during upgrade process<br/>
&ndash; Start additional SSH daemon = YES<br/>
&ndash; Include latest updates from the Internet = NO<br/>
&ndash; The rest is all YES<br/>
5. Reboot</p>

<p><strong>Upgrade 9.10 to 10.04LTS</strong><br/>
6. Install the required package</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">update</span><span class="o">-</span><span class="n">manager</span><span class="o">-</span><span class="n">core</span>
</span></code></pre></td></tr></table></div></figure>


<p>
7. Modify the release-upgrades</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">update</span><span class="o">-</span><span class="n">manager</span><span class="o">/</span><span class="n">release</span><span class="o">-</span><span class="n">upgrades</span>
</span><span class='line'><span class="n">set</span> <span class="n">Prompt</span><span class="o">=</span><span class="n">normal</span>
</span><span class='line'><span class="k">do</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">upgrade</span>
</span></code></pre></td></tr></table></div></figure>


<p>
8. Reboot<br/>
9. To make sure everything is up-to-date</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">f</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Installing packages on an out-of-support Ubuntu 9.04]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/14/installing-packages-on-an-out-of-support-ubuntu-9-04/"/>
    <updated>2011-07-14T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/14/installing-packages-on-an-out-of-support-ubuntu-9-04</id>
    <content type="html"><![CDATA[<p>By now your 9.04 (Jaunty) is out of support and at some point you might want to install a package from Ubuntu repositories. You will need need to tweak a few things before you can install or upgrade your packages. Here&#8217;s an easy way to this:</p>

<p><strong>Edit and update where Ubuntu gets it&#8217;s packages from</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="p">.</span><span class="n">list</span>
</span><span class='line'><span class="o">:%</span><span class="n">s</span><span class="o">/</span><span class="n">us</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">old</span><span class="o">-</span><span class="n">releases</span><span class="p">.</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">g</span>
</span><span class='line'><span class="o">:%</span><span class="n">s</span><span class="o">/</span><span class="n">security</span><span class="p">.</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">old</span><span class="o">-</span><span class="n">releases</span><span class="p">.</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">g</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Update and resynchronize the package indexes</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now you should be able to install or upgrade packages</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fresh Installation of Bugzilla on Ubuntu]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/13/fresh-installation-of-bugzilla-on-ubuntu/"/>
    <updated>2011-07-13T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/13/fresh-installation-of-bugzilla-on-ubuntu</id>
    <content type="html"><![CDATA[<p><strong>Install required packages</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">perl</span> <span class="n">mysql</span><span class="o">-</span><span class="n">server</span> <span class="n">mysql</span><span class="o">-</span><span class="n">client</span> <span class="n">mysql</span><span class="o">-</span><span class="n">admin</span> <span class="n">apache2</span>
</span><span class='line'><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">libcgi</span><span class="o">-</span><span class="n">pm</span><span class="o">-</span><span class="n">perl</span> <span class="n">libdigest</span><span class="o">-</span><span class="n">sha1</span><span class="o">-</span><span class="n">perl</span> <span class="n">timedate</span> <span class="n">libdatetime</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">sunrise</span><span class="o">-</span><span class="n">perl</span> <span class="n">libdbi</span><span class="o">-</span><span class="n">perl</span> <span class="n">libhtml</span><span class="o">-</span><span class="n">template</span><span class="o">-</span><span class="n">perl</span> <span class="n">libemail</span><span class="o">-</span><span class="n">send</span><span class="o">-</span><span class="n">perl</span> <span class="n">libemail</span><span class="o">-</span><span class="n">mime</span><span class="o">-</span><span class="n">perl</span> <span class="n">libemail</span><span class="o">-</span><span class="n">mime</span><span class="o">-</span><span class="n">encodings</span><span class="o">-</span><span class="n">perl</span> <span class="n">libemail</span><span class="o">-</span><span class="n">mime</span><span class="o">-</span><span class="n">modifier</span><span class="o">-</span><span class="n">perl</span> <span class="n">liburi</span><span class="o">-</span><span class="n">perl</span> <span class="n">libdbd</span><span class="o">-</span><span class="n">mysql</span><span class="o">-</span><span class="n">perl</span> <span class="n">libtoolkit</span><span class="o">-</span><span class="n">perl</span> <span class="n">libtemplate</span><span class="o">-</span><span class="n">perl</span> <span class="n">libgd</span><span class="o">-</span><span class="n">gd2</span><span class="o">-</span><span class="n">perl</span> <span class="n">libchart</span><span class="o">-</span><span class="n">perl</span> <span class="n">libtemplate</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">gd</span><span class="o">-</span><span class="n">perl</span> <span class="n">libxml</span><span class="o">-</span><span class="n">twig</span><span class="o">-</span><span class="n">perl</span> <span class="n">libmime</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">perl</span> <span class="n">libwww</span><span class="o">-</span><span class="n">perl</span> <span class="n">perlmagick</span> <span class="n">libnet</span><span class="o">-</span><span class="n">ldap</span><span class="o">-</span><span class="n">perl</span> <span class="n">libauthen</span><span class="o">-</span><span class="n">sasl</span><span class="o">-</span><span class="n">perl</span> <span class="n">libauthen</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">radius</span><span class="o">-</span><span class="n">perl</span> <span class="n">libsoap</span><span class="o">-</span><span class="n">lite</span><span class="o">-</span><span class="n">perl</span> <span class="n">libhtml</span><span class="o">-</span><span class="n">parser</span><span class="o">-</span><span class="n">perl</span> <span class="n">libhtml</span><span class="o">-</span><span class="n">scrubber</span><span class="o">-</span><span class="n">perl</span> <span class="n">libtheschwartz</span><span class="o">-</span><span class="n">perl</span> <span class="n">libapache2</span><span class="o">-</span><span class="n">mod</span><span class="o">-</span><span class="n">perl2</span> <span class="n">libfile</span><span class="o">-</span><span class="n">slurp</span><span class="o">-</span><span class="n">perl</span> <span class="n">libfile</span><span class="o">-</span><span class="n">flock</span><span class="o">-</span><span class="n">perl</span> <span class="n">libyaml</span><span class="o">-</span><span class="n">perl</span>
</span></code></pre></td></tr></table></div></figure>




<!--more-->


<p><strong>Configure Database</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span>
</span><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">database</span> <span class="n">bugzilla</span><span class="p">;</span>
</span><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">grant</span> <span class="n">all</span> <span class="n">privileges</span> <span class="n">on</span> <span class="n">bugzilla</span><span class="p">.</span><span class="o">*</span> <span class="n">to</span> <span class="n">bugzilla</span><span class="p">@</span><span class="n">localhost</span> <span class="n">identified</span> <span class="n">by</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">bugzilla</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Download and untar bugzilla </strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">bugzilla</span><span class="o">-</span><span class="mf">3.</span><span class="n">x</span>
</span><span class='line'><span class="err">$</span> <span class="n">mv</span> <span class="n">bugzilla</span><span class="o">-</span><span class="mf">3.</span><span class="n">x</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bugzilla</span><span class="o">-</span><span class="mf">3.</span><span class="n">x</span>
</span><span class='line'><span class="err">$</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bugzilla3</span><span class="p">.</span><span class="n">x</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">bugzilla</span>
</span><span class='line'><span class="err">$</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bugzilla</span><span class="o">-</span><span class="mf">3.</span><span class="n">x</span>
</span><span class='line'><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">checksetup</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">check</span><span class="o">-</span><span class="n">modules</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Most likely the installer will complain about missing modules. Here&#8217;s how you can install them:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">perl</span> <span class="n">install</span><span class="o">-</span><span class="n">module</span><span class="p">.</span><span class="n">pl</span> <span class="n">Daemon</span><span class="o">::</span><span class="n">Generic</span>
</span><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">perl</span> <span class="n">install</span><span class="o">-</span><span class="n">module</span><span class="p">.</span><span class="n">pl</span> <span class="n">Email</span><span class="o">::</span><span class="n">Reply</span>
</span><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">perl</span> <span class="n">install</span><span class="o">-</span><span class="n">module</span><span class="p">.</span><span class="n">pl</span> <span class="n">PatchReader</span>
</span><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">perl</span> <span class="n">install</span><span class="o">-</span><span class="n">module</span><span class="p">.</span><span class="n">pl</span> <span class="n">Email</span><span class="o">::</span><span class="n">MIME</span><span class="o">::</span><span class="n">Attachment</span><span class="o">::</span><span class="n">Stripper</span>
</span><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">perl</span> <span class="n">install</span><span class="o">-</span><span class="n">module</span><span class="p">.</span><span class="n">pl</span> <span class="n">Template</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Recheck for missing modules and if successful, continue with the install</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">checksetup</span><span class="p">.</span><span class="n">pl</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8211</span><span class="p">;</span><span class="n">check</span><span class="o">-</span><span class="n">modules</span>
</span><span class='line'><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">checksetup</span><span class="p">.</span><span class="n">pl</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Edit bugzilla&#8217;s configuration file and enter your database information</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="n">vim</span> <span class="n">localconfig</span>
</span><span class='line'><span class="n">Edit</span> <span class="n">following</span>
</span><span class='line'><span class="err">$</span><span class="n">webservergroup</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span><span class='line'><span class="err">$</span><span class="n">db_name</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">bugzilla</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span><span class='line'><span class="err">$</span><span class="n">db_user</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">bugzilla</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span><span class='line'><span class="err">$</span><span class="n">db_pass</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8216</span><span class="p">;</span><span class="n">bugzilla</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8217</span><span class="p">;;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Modify the database to support larger attachement sizes</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span>
</span><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">bugzilla</span><span class="p">;</span>
</span><span class='line'><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">alter</span> <span class="n">table</span> <span class="n">attachments</span> <span class="n">avg</span><span class="err">\</span><span class="n">_row</span><span class="err">\</span><span class="n">_length</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">20000</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Configure Apache2 and your VirtualHost</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">checksetup</span><span class="p">.</span><span class="n">pl</span>
</span><span class='line'><span class="err">$</span> <span class="n">vim</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">bugzilla</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*:</span><span class="mi">80</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">ServerName</span> <span class="n">bugzilla</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'><span class="n">ServerAlias</span> <span class="n">bugs</span> <span class="n">bugs</span><span class="p">.</span><span class="n">test</span> <span class="n">bugs</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span> <span class="n">bugzilla</span> <span class="n">bugzilla</span><span class="p">.</span><span class="n">fs</span>
</span><span class='line'><span class="n">ServerAdmin</span> <span class="n">root</span><span class="p">@</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
</span><span class='line'><span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">bugzilla</span>
</span><span class='line'><span class="n">ErrorLog</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">|/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">rotatelogs</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">bugzilla</span><span class="p">.</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">d</span><span class="p">.</span><span class="n">error</span> <span class="mi">86400</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span>
</span><span class='line'><span class="n">CustomLog</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">8220</span><span class="p">;</span><span class="o">|/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">rotatelogs</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">bugzilla</span><span class="p">.</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">d</span><span class="p">.</span><span class="n">log</span> <span class="mi">86400</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">8243</span><span class="p">;</span> <span class="n">common</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">Alias</span> <span class="o">/</span><span class="n">bugzilla</span><span class="o">/</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">bugzilla</span><span class="o">/</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">Directory</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">bugzilla</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">AddHandler</span> <span class="n">cgi</span><span class="o">-</span><span class="n">script</span> <span class="p">.</span><span class="n">cgi</span> <span class="p">.</span><span class="n">pl</span>
</span><span class='line'><span class="n">Options</span> <span class="o">+</span><span class="n">Indexes</span> <span class="o">+</span><span class="n">ExecCGI</span> <span class="o">+</span><span class="n">FollowSymLinks</span>
</span><span class='line'><span class="n">DirectoryIndex</span> <span class="n">index</span><span class="p">.</span><span class="n">cgi</span>
</span><span class='line'><span class="n">AllowOverride</span> <span class="n">Limit</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Create a symbolic link to enable bugzilla&#8217;s VirtualHost </strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">bugzilla</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enables</span><span class="o">/</span><span class="n">bugzilla</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Start/Restart Apache</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">initd</span><span class="p">.</span><span class="o">/</span><span class="n">apache2</span> <span class="n">restart</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Upgraded my Mac to 8GB RAM (First Gen Unibody with Removable Battery)]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/12/upgraded-my-mac-to-8gb-ram-first-gen-unibody-with-removable-battery/"/>
    <updated>2011-07-12T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/12/upgraded-my-mac-to-8gb-ram-first-gen-unibody-with-removable-battery</id>
    <content type="html"><![CDATA[<p>While not exactly supported by Apple the &#8220;13-inch, Aluminum, Late 2008&#8243; version of the MacBook (Renamed to MacBook Pro) supports 8GB of Memory.</p>

<p>Originally purchased this Mac with 2GB RAM and Upgraded it to 4GB on day one. Had I known more memory was supported (officially or unofficially) my laptop would have been rocking more RAM much sooner.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Used OSX 10.7 Lion for 12 hours and the verdict is: Meh :(]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/10/used-osx-10-7-lion-for-12-hours-and-the-verdict-is-meh/"/>
    <updated>2011-07-10T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/10/used-osx-10-7-lion-for-12-hours-and-the-verdict-is-meh</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Nook Color with Gingerbread]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/10/nook-color-with-gingerbread/"/>
    <updated>2011-07-10T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/10/nook-color-with-gingerbread</id>
    <content type="html"><![CDATA[<p><strong>Requirements</strong><br/>
Hardware<br/>
1. Nook Color [Purchase: <a href="http://www.barnesandnoble.com/nookcolor/index.asp">http://www.barnesandnoble.com/nookcolor/index.asp</a>]<br/>
2. SD Card [Purchase: <a href="http://www.amazon.com/Transcend-Class-Flash-Memory-TS16GSDHC10E/dp/B003VNKNEQ/ref=sr_1_3?ie=UTF8&amp;qid=1310314654&amp;sr=8-3">http://www.amazon.com/Transcend-Class-Flash-Memory-TS16GSDHC10E/dp/B003VNKNEQ/ref=sr_1_3?ie=UTF8&amp;qid=1310314654&amp;sr=8-3</a>]</p>

<!--more-->


<p>Software<br/>
3. ClockworkMod Recovery v3.0.0.6 Image [Download: <a href="http://forum.xda-developers.com/showthread.php?t=959240%5D">http://forum.xda-developers.com/showthread.php?t=959240%5D</a>]<br/>
4. cyanogen(mod) ROM Image [Download: <a href="http://download.cyanogenmod.com/?device=encore&amp;type=nightly">http://download.cyanogenmod.com/?device=encore&amp;type=nightly</a>]<br/>
5. Google Apps [Download: <a href="http://wiki.cyanogenmod.com/index.php?title=Latest_Version/Google_Apps">http://wiki.cyanogenmod.com/index.php?title=Latest_Version/Google_Apps</a>]<br/>
6. Overclock Kernel [Download: <a href="http://forum.xda-developers.com/showthread.php?t=925451">http://forum.xda-developers.com/showthread.php?t=925451</a>]</p>

<p><strong>Prep your SD Card:</strong><br/>
1. Created a 1GB ClockworkMod bootable SD<br/>
2. Copied ROM Image, Google Apps and Overclock Kernel to the bootable SD</p>

<p><strong>Installation:</strong><br/>
1. Insert SD bard into the Nook Color and Power on<br/>
2. Format the current partitions<br/>
a. &#8216;mounts and storage&#8217; &#8211;>; format /system<br/>
b. &#8216;mounts and storage&#8217; &#8211;>; format /data<br/>
c. &#8216;mounts and storage&#8217; &#8211;>; format /cache<br/>
3. Back to main menu<br/>
4. Install new ROM, Apps and optional Overclock Kernel<br/>
d. &#8216;install zip from sdcard&#8217; &#8211;>; &#8216;choose zip from sdcard&#8217; &#8211;>; select &#8220;latest_CM7_nightly.zip&#8221;<br/>
e. &#8216;install zip from sdcard&#8217; &#8211;>; &#8216;choose zip from sdcard&#8217; &#8211;>; select &#8220;gapps-gb-20110120-signed.zip&#8221;<br/>
f. &#8216;install zip from sdcard&#8217; &#8211;>; &#8216;choose zip from sdcard&#8217; &#8211;>; select &#8220;update-1100mhz-froyo_CM7-emmc-cwm.zip&#8221; [Optional: Nook runs great without it]<br/>
5. Take out the SD Card<br/>
6. Reboot</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[New discovery with Lion&#8230; Parallels 5 will not work! I finally had to upgrade to Parallels 6 to get access to my BootCamp and VMs.]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/09/new-discovery-with-lion-parallels-5-will-not-work-i-finally-had-to-upgrade-to-parallels-6-to-get-access-to-my-bootcamp-and-vms/"/>
    <updated>2011-07-09T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/09/new-discovery-with-lion-parallels-5-will-not-work-i-finally-had-to-upgrade-to-parallels-6-to-get-access-to-my-bootcamp-and-vms</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[I have some adjusting to do with OSX Lion. Got the new gestures down, but my favorite 2 are missing from this version of the Operation System :(]]></title>
    <link href="http://mmoghadas.github.io/blog/2011/07/09/i-have-some-adjusting-to-do-with-osx-lion-got-the-new-gestures-down-but-my-favorite-2-are-missing-from-this-version-of-the-operation-system/"/>
    <updated>2011-07-09T00:00:00-07:00</updated>
    <id>http://mmoghadas.github.io/blog/2011/07/09/i-have-some-adjusting-to-do-with-osx-lion-got-the-new-gestures-down-but-my-favorite-2-are-missing-from-this-version-of-the-operation-system</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
</feed>
